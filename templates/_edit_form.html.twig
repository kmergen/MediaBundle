{# templates/media/_edit_form.html.twig #}

{{ form_start(form, {
    'attr': {
    'class': 'kmm-form-stack',
    'data-turbo': 'false'
    }
    }) }}

    {# 1. VORSCHAU-BILD #}
    <div class="kmm-modal-preview-box">
        <img src="{{ asset(previewUrl) }}"
             alt="{{ 'dashboard.modal.preview_alt'|trans({}, 'KmMedia') }}"
             class="kmm-modal-preview-img">
    </div>

    {# 2. DYNAMISCHE ALT-TEXT FELDER #}
    <div class="kmm-form-stack">
        {% for locale in locales %}
            {% set fieldName = 'alt_' ~ locale %}
            {% set field = attribute(form, fieldName) %}

            <div class="kmm-form-group">
                {# Label mit Ersetzung des Platzhalters %locale% durch z.B. DE, EN #}
                <label class="kmm-form-label" for="{{ field.vars.id }}">
                    {{ field.vars.label|trans({'%locale%': locale|upper}, 'KmMedia') }}
                </label>

                {{ form_widget(field, {
                                'value': media.getAlt(locale) ,
                'attr': {
                'class': 'kmm-form-input',
                'placeholder': field.vars.attr.placeholder|trans({}, 'KmMedia'),
                'data-action': 'keydown.enter->media-upload#submitEdit'
                }
                }) }}

                {{ form_errors(field) }}
            </div>
        {% endfor %}

        {# HILFETEXT (SEO HINWEIS) #}
        <p class="kmm-form-help mt-2">{{ 'dashboard.modal.help_text'|trans({}, 'KmMedia') }}</p>
    </div>

    {# GLOBALE FORM-FEHLER #}
    {{ form_errors(form) }}

    {# 3. BUTTONS #}
    <div class="kmm-modal-actions">
        {# Abbrechen schließt das Modal via Stimulus #}
        <button type="button"
                class="kmm-btn-cancel"
                data-action="click->media-upload#closeModal">
            {{ 'dashboard.buttons.cancel'|trans({}, 'KmMedia') }}
        </button>

        {# Submit löst media-upload#submitEdit via Event-Listener aus connect() aus #}
        <button type="submit" class="kmm-btn-save">{{ 'dashboard.buttons.save'|trans({}, 'KmMedia') }}</button>
    </div>

{{ form_end(form) }}
