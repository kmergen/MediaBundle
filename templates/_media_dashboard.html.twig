{# _media_dashboard.html.twig #}

<div class="kmm-dashboard-container"
     data-controller="media-upload"
     data-media-upload-max-files-value="{{ config.maxFiles }}"
     data-media-upload-max-file-size-value="{{ config.maxFileSize }}"
     data-media-upload-min-width-value="{{ config.minWidth }}"
     data-media-upload-min-height-value="{{ config.minHeight }}"
     data-media-upload-allowed-mime-types-value="{{ config.allowedMimeTypes|json_encode }}"
     data-media-upload-context-value="{{ config.context }}"
     data-media-upload-initial-images-value="{{ config.images|json_encode }}"
     data-media-upload-album-id-value="{{ config.albumId }}"
     data-media-upload-auto-save-value="{{ config.autoSave ? 'true' : 'false' }}"
     data-media-upload-temp-key-value="{{ config.tempKey }}"
     data-media-upload-image-variants-value="{{ config.imageVariants|json_encode }}"
     data-media-upload-editable-alt-text-locales-value="{{ config.editableAltTextLocales ? config.editableAltTextLocales|join(",") : '' }}"
     data-media-upload-translations-value="{{ config.translations|json_encode }}"
     data-media-upload-csrf-value="{{ csrf_token("media_delete") }}">

       {% if config.title is defined and config.title %}<h2 class="kmm-dashboard-title">{{ config.title }}</h2>{% endif %}

       <div data-media-upload-target="errorBox" class="kmm-error-box kmm-hidden"></div>

       <div data-media-upload-target="previewList"
            class="kmm-dashboard-preview-grid">{# JS füllt diesen Bereich basierend auf initial-images-value #}</div>

       {# 2. DROPZONE (Jetzt UNTEN, Volle Breite) #}
       <div data-media-upload-target="dropzone"
            data-action="click->media-upload#onDropzoneClick dragover->media-upload#onDragOver dragleave->media-upload#onDragLeave drop->media-upload#onDrop"
            class="kmm-dashboard-dropzone">
              <div class="kmm-dropzone-info">
                     <svg class="kmm-dropzone-info-svg"
                          fill="none"
                          stroke="currentColor"
                          viewbox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12">
                            </path>
                     </svg>
                     <p class="kmm-dropzone-info-text">{{ 'dashboard.dropzone_help'|trans({}, 'KmMedia') }}</p>
              </div>
              <input type="file"
                     data-media-upload-target="input"
                     data-action="change->media-upload#onFileChange"
                     multiple
                     accept="image/*"
                     class="hidden">
       </div>

       {# 3. Media_ids) #}
       <input type="hidden"
              data-media-upload-target="mediaIds"
              name="mediaIds"
              value="">

       {# 4. Die Album ID #}
       <input type="hidden"
              data-media-upload-target="albumId"
              name="mediaAlbumId"
              value="{{ config.albumId|default("") }}">

       {# 5. Der TempKey (für die Finalisierung/Cleanup) #}
       <input type="hidden"
              data-media-upload-target="tempKey"
              name="mediaTempKey"
              value="{{ config.tempKey }}">

       {# ... Modal für edit action ... #}
       {% include '@Media/_media_modal.html.twig' %}

</div>
